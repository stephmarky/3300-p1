<html>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<svg height="1000" width="1000" id="graph2">
</svg>
<script>

// COPY PASTED and EDITED

var linearEduScale= d3.scaleLinear()
.domain([0, 20])
.range([0, 5]);

// Next we use a powerScale with exponent 0.5 to change the initial variable
// such that the area is linear and correct
var areaEduScale= d3.scalePow().
exponent([0.5]);

// Since attr modification takes in a string, we must transform each scale value
// into a string such that .attr("transform", to_string_scale(value)) is in
// an acceptable format
var to_string_scale= function(variable) {
  return "scale(" + variable + ", " + variable + ")";
};

// Combines all functions into one
var eduImageHelper= function(healthData) {
  return to_string_scale(areaEduScale(linearEduScale(healthData)));
};

// Transforms x and y coordinates into a translate function string input
// so that it is compatible with a .attr call
var to_string_x_y= function(x, y) {
  return "translate(" + x + "," + y + ")";
};

// Concatenates the transform functions into one, else overwriting will occur
var transformHelper= function(x, y, imageHelperUsed, dataPoint) {
  return to_string_x_y(x, y) + " " + imageHelperUsed(dataPoint);
};


// Select svg2
var svg2= d3.select("#graph2");

var imageGenerator= function (d) {

  // Test code to center


  var image= svg2.append("g")
  .attr("transform", transformHelper(d.x, d.y, eduImageHelper, d.size));

  var innerimage= image.append("g")
  .attr("transform", "translate(-28.5, -28.5)")

  // Test code to view center

  innerimage.append("path")
  .attr("d", "M17.775,17.594L4.667,30.702c-6.223,6.223-6.223,16.405,0,22.627h0   c6.223,6.223,16.405,6.223,22.627,0l13.108-13.108L17.775,17.594z")
  .style("fill", "#DD352E")

  innerimage.append("path")
  .attr("d", "M40.422,40.202l12.908-12.907c6.222-6.223,6.222-16.405,0-22.627h0   c-6.223-6.223-16.405-6.223-22.627,0L17.794,17.574L40.422,40.202z")
  .style("fill", "#EBBA16")

  innerimage.append("path")
  .attr("d", "M22.046,21.826l-17.11,17.11c-0.586,0.585-0.586,1.536,0,2.121c0.293,0.293,0.677,0.439,1.061,0.439   s0.768-0.146,1.061-0.439l17.11-17.11L22.046,21.826z")
  .style("fill", "#F46767")

  innerimage.append("path")
  .attr("d", "M24.165,23.948L40.057,8.057c0.586-0.585,0.586-1.536,0-2.121c-0.586-0.586-1.535-0.586-2.121,0   L22.044,21.827L24.165,23.948z")
  .style("fill", "#FCD770")

  // svg2.append("line")
  // .style("stroke", "black")
  // .style("stroke-width", 1)
  // .attr("x1", 0)
  // .attr("y1", 0)
  // .attr("x2", 200)
  // .attr("y2", 200)
  //
  // svg2.append("line")
  // .style("stroke", "black")
  // .style("stroke-width", 1)
  // .attr("x1", 200)
  // .attr("y1", 0)
  // .attr("x2", 0)
  // .attr("y2", 200)

  svg2.append("circle")
  .attr("r", 1)
  .attr("cx", 500)
  .attr("cy", 500)
  .style("fill", "gray");
}

// Test code to center

// svg2.append("circle")
// .attr("r", 200)
// .attr("cx", 500)
// .attr("cy", 500)
// .style("fill", "gray");


// Single image code

imageGenerator({"x": 500, "y": 500, "size": 50});


// Demo code

// var exampleArray= [{"x": 40, "y":50, "size": 3},
// {"x": 850, "y":20, "size": 5},
// {"x": 500, "y":500, "size": 4},
// {"x": 50, "y":600, "size": 8},
// {"x": 900, "y":700, "size": 3}];
//
// exampleArray.forEach(function (d) {
//   imageGenerator(d);
// });

</script>
</html>
